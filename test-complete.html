<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaspa Ecosystem - Test Suite</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0F172A;
            color: #CBD5E1;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 { color: #49EACB; }
        .test-section {
            background: #1E293B;
            padding: 20px;
            margin: 20px 0;
            border-radius: 12px;
            border: 1px solid #334155;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            background: #334155;
            border-radius: 8px;
        }
        .success { color: #10B981; }
        .error { color: #EF4444; }
        .pending { color: #F59E0B; }
        button {
            background: #49EACB;
            color: #0F172A;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        button:hover {
            background: #34D399;
        }
        .log {
            background: #0F172A;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>üöÄ Kaspa Ecosystem - Suite de Tests</h1>
    
    <div class="test-section">
        <h2>1. Test de Connexion Wallet</h2>
        <button onclick="testWalletConnection()">Tester Connexion Mock Wallet</button>
        <div id="wallet-result" class="test-item pending">En attente...</div>
    </div>
    
    <div class="test-section">
        <h2>2. Test du Carousel</h2>
        <button onclick="testCarousel()">V√©rifier Carousel</button>
        <div id="carousel-result" class="test-item pending">En attente...</div>
    </div>
    
    <div class="test-section">
        <h2>3. Test de Sponsoring</h2>
        <button onclick="testSponsorship()">Simuler Ench√®re</button>
        <div id="sponsor-result" class="test-item pending">En attente...</div>
    </div>
    
    <div class="test-section">
        <h2>4. Test Report Scam</h2>
        <button onclick="testScamReport()">Simuler Report</button>
        <div id="scam-result" class="test-item pending">En attente...</div>
    </div>
    
    <div class="test-section">
        <h2>5. Test des Fonctions Admin</h2>
        <button onclick="testAdminFunctions()">V√©rifier Admin</button>
        <div id="admin-result" class="test-item pending">En attente...</div>
    </div>
    
    <div class="test-section">
        <h2>Console Log</h2>
        <div id="console-log" class="log"></div>
    </div>
    
    <script>
        // Helper pour logger
        function log(message, type = 'info') {
            const logDiv = document.getElementById('console-log');
            const time = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#EF4444' : type === 'success' ? '#10B981' : '#94A3B8';
            logDiv.innerHTML += `<span style="color: ${color}">[${time}] ${message}</span>\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        // Test 1: Connexion Wallet
        async function testWalletConnection() {
            const resultDiv = document.getElementById('wallet-result');
            try {
                log('Test connexion wallet...');
                
                // Simuler la d√©tection du wallet
                if (window.kasware || window.mockWallet) {
                    resultDiv.innerHTML = '<span class="success">‚úì Mock wallet d√©tect√©</span>';
                    log('Wallet d√©tect√© avec succ√®s', 'success');
                } else {
                    // Cr√©er un mock wallet pour test
                    window.mockWallet = {
                        requestAccounts: async () => ['kaspa:test123'],
                        getBalance: async () => ({ confirmed: 1000000000 })
                    };
                    resultDiv.innerHTML = '<span class="success">‚úì Mock wallet cr√©√© pour test</span>';
                    log('Mock wallet cr√©√©', 'success');
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå Erreur: ${error.message}</span>`;
                log(`Erreur wallet: ${error.message}`, 'error');
            }
        }
        
        // Test 2: Carousel
        async function testCarousel() {
            const resultDiv = document.getElementById('carousel-result');
            try {
                log('V√©rification du carousel...');
                
                // V√©rifier si l'√©l√©ment existe
                const carousel = document.querySelector('#featured-carousel');
                if (carousel) {
                    resultDiv.innerHTML = '<span class="success">‚úì Section carousel trouv√©e</span>';
                    log('Carousel pr√©sent dans le DOM', 'success');
                } else {
                    resultDiv.innerHTML = '<span class="error">‚ùå Carousel non trouv√© - V√©rifier index.html</span>';
                    log('Carousel manquant', 'error');
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå Erreur: ${error.message}</span>`;
                log(`Erreur carousel: ${error.message}`, 'error');
            }
        }
        
        // Test 3: Sponsorship
        async function testSponsorship() {
            const resultDiv = document.getElementById('sponsor-result');
            try {
                log('Test du syst√®me de sponsoring...');
                
                // V√©rifier si les fonctions existent
                if (typeof app !== 'undefined' && app.sponsorshipSystem) {
                    resultDiv.innerHTML = '<span class="success">‚úì Syst√®me de sponsoring d√©tect√©</span>';
                    log('KaspaSponsorshipSystem pr√©sent', 'success');
                } else {
                    resultDiv.innerHTML = '<span class="pending">‚ö†Ô∏è Chargez d\'abord la page principale</span>';
                    log('App non charg√©e', 'error');
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå Erreur: ${error.message}</span>`;
                log(`Erreur sponsoring: ${error.message}`, 'error');
            }
        }
        
        // Test 4: Report Scam
        async function testScamReport() {
            const resultDiv = document.getElementById('scam-result');
            try {
                log('Test du syst√®me de report...');
                
                // V√©rifier l'endpoint
                const response = await fetch('/.netlify/functions/send-scam-alert-webhook', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        projectId: 'test-project-id',
                        reportCount: 5
                    })
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '<span class="success">‚úì Endpoint webhook fonctionnel</span>';
                    log('Webhook test r√©ussi', 'success');
                } else {
                    resultDiv.innerHTML = '<span class="error">‚ùå Webhook non configur√©</span>';
                    log('Configurez DISCORD_WEBHOOK_URL dans Netlify', 'error');
                }
            } catch (error) {
                resultDiv.innerHTML = '<span class="pending">‚ö†Ô∏è Test local - D√©ployer pour tester</span>';
                log('Test en local, d√©ployer sur Netlify', 'info');
            }
        }
        
        // Test 5: Admin
        async function testAdminFunctions() {
            const resultDiv = document.getElementById('admin-result');
            try {
                log('V√©rification des fonctions admin...');
                
                // V√©rifier si la page admin existe
                const adminResponse = await fetch('/admin-enhanced.html');
                if (adminResponse.ok) {
                    resultDiv.innerHTML = '<span class="success">‚úì Interface admin accessible</span>';
                    log('Admin panel disponible', 'success');
                } else {
                    resultDiv.innerHTML = '<span class="error">‚ùå Page admin introuvable</span>';
                    log('V√©rifier admin-enhanced.html', 'error');
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå Erreur: ${error.message}</span>`;
                log(`Erreur admin: ${error.message}`, 'error');
            }
        }
        
        // Auto-test au chargement
        window.onload = () => {
            log('Suite de tests Kaspa Ecosystem charg√©e', 'success');
            log('Cliquez sur les boutons pour ex√©cuter les tests', 'info');
        };
    </script>
</body>
</html>
